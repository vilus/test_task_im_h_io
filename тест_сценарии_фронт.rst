0. Подготовка

  .. note:: Уточнить по [браузерам, платформам, разрешениям] -> выполнять под требуемые варианты
  ..

  * 0.1. "Чистый" браузер
  * 0.2. dev tools
  * 0.3. управление вероятностью показа всплывающего окна

1. Частота показа

  * 1.1. Рейт показа 100%  (нужно для валидации способа управления вероятностью показа всплывашки)
  * 1.2. Рейт показа 0%  (нужно для валидации способа управления вероятностью показа всплывашки)
  * 1.3. Рейт показа 10% [опционально]


2. Запрет кукой

  * 2.1. Кука установлена
      * 2.1.1. Рейт показа 100%

  * 2.2. Кука не установлена
      * 2.2.1. Рейт показа 100%


3. Всплывающее окно

  * 3.1. Дефолтное окно
      * 3.1.1. Внешний вид
          * 3.1.1.1. Крестик
          * 3.1.1.2. Текст
          * 3.1.1.3. Кнопки оценок

      * 3.1.2. Закрытие по крестику
      * 3.1.3. Выбор положительной оценки [7, 8, 10]
      * 3.1.4. Выбор отрицательной оценки [0, 3, 6]

  * 3.2. Окно с отзывом
      * 3.2.1. Внешний вид
          * 3.2.1.1. Крестик
          * 3.2.1.2. Текст
          * 3.2.1.3. Поле ввода
          * 3.2.1.4. Кнопка отправки

      * 3.2.2. Закрытие по крестику
      * 3.2.3. Отправка отзыва
          * 3.2.3.1. С пустым комментарием
          * 3.2.3.2. С комментарием (уточнить допустимую длинну по ТЗ)
          * 3.2.3.3. С комментарием превышающей длины (уточнение по ТЗ)
          * 3.2.3.4. С комментарием с спец. символами (после уточнения по ТЗ, про экранирование)

--------

0.1. "Чистый" браузер
  К примеру запускать браузер в режиме инкогнито,
  для хрома: Ctrl + Shift + N

  **Изменить разрешение окна, если требуется**


0.2. dev tools
  Инструменты разработчика (в браузере), потребуются для управления рейтом показа, провери кук, запросов и тд.,
  для хрома F12


0.3. управление вероятностью показа всплывающего окна
  Для упрощения кейсов нужен способ управлять вероятностью показа всплывашки,
  за неимением "официального"/согласованного/специального подхода будет использоваться "временный" способ,
  100% вероятность показа (0.3.1.):

    ::

        отрыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:
        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()


  0%  вероятность показа (0.3.2.):

    ::

        отрыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:
        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 42;};
        win.focus()


1.1. Рейт показа 100% (если не пройдет, другие кейсы нельзя проверять)
  * 1. открыть окно с показанной всплывашкой (пункт 0.3.1.)
  * 2. проверить, что всплывашка появилась
  * 3. закрыть активную вкладку (Ctrl+W для хрома)
  * 4. повторить пункты [1-3] 5 раз (переоткрывать браузер не обязательно, можно просто повторять код в консоли)


1.2. Рейт показа 0% (если не пройдет, другие кейсы нельзя проверять)
  * 1. открыть окно без показанной всплывашкой (пункт 0.3.2.)
  * 2. проверить, что всплывашка не появилась
  * 3. закрыть активную вкладку (Ctrl+W для хрома)
  * 4. повторить пункты [1-3] 15 раз (переоткрывать браузер не обязательно, можно просто повторять код в консоли)


1.3. Рейт показа (примерно) 10%  [опционально]
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.focus()

  * 2. проверить отобразилась ли всплывашка
  * 3. повторить пункты [1-2] 10 раз, ожидаемое количество показов всплывашки от 0 до 3 (запомнить это число)
  * 4. повторить пункт [3] 5 раза, если общее число показов 0 или больше 15, то или _очень_ сильно
       не _повезло_ или изменилась частота показа, в любом случае проверкой в данном виде нельзя однозначно удверждать


2.1.1. Запрет кукой / Кука установлена / Рейт показа 100%
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=1;path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. проверить, что всплывашка не появилась
  * 3. закрыть активную вкладку (Ctrl+W для хрома)


2.2.1. Запрет кукой / Кука не установлена / Рейт показа 100%
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. проверить, что всплывашка появилась
  * 3. закрыть активную вкладку (Ctrl+W для хрома)


3.1.1. Всплывающее окно / Дефолтное окно / Внешний вид
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. проверить наличие крестика в правом верхнем углу всплывашки
  * 3. проверить текст всплывашки:
        * 3.1. наличие "How likely are you to recommend our website to a friend?"
        * 3.2. наличие "Not at all likely" - по левой стороне, над кнопками оценок
        * 3.3. наличие "Extremely likely" - по правой стороне, над кнопками оценок
  * 4. проверить кнопки оценок, *горизонтальный* ряд из 11 кнопок с текстом от 0 до 10
  * 5. закрыть активную вкладку (Ctrl+W для хрома)


3.1.2. Всплывающее окно / Дефолтное окно / Закрытие по крестику
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. открыть dev tools
  * 3. нажать на крестик в правом верхнем углу всплывашки
  * 4. проверить, что всплывашка закрылась
  * 5. проверить, что установилась "запрещающая" кука (TODO: как временное решение в dev tools->Application->Cookies):
        * 5.1. "Name" равен "NPS_sended"
        * 5.2. "Value" равен "1"
        * 5.3. "Path" равен "/" (уточнить по ТЗ, на всякий)
        * 5.4. "Expires / Max-Age" **не** равен "Session" (ожидаемое значение уточнить по ТЗ)
  * 6. проверить, что в dev tools->Network **не** появился запрос "nps" с типом "xhr"
  * 7. закрыть активную вкладку (Ctrl+W для хрома)


3.1.3. Всплывающее окно / Дефолтное окно / Выбор положительной оценки [7, 8, 10]
  * 0. повторить пункты [1-8] для *оценок* [7, 8, 10] - выбирая соответственно нужную кнопку в пункте 3
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. открыть dev tools->Network
  * 3. нажать кнопку с цифрой выбранной оценки
  * 4. проверить, что всплывашка закрылась
  * 5. проверить, что в dev tools->Network появился запрос "nps" с типом "xhr"
  * 6. кликнуть по запросу в столбце "Name", выбрать "Headers", проверить:
        * 6.0. в "General" -> "Status Code" = "200 OK"
        * 6.1. в "General" -> "Request URL" заканчивается на "/nps"
        * 6.2. в "General" -> "Request Method" = "POST"
        * 6.3. в "Request Headers" -> "Content-Type:" = "application/json; charset=UTF-8" (TODO: возможно убрать, после уточнения ТЗ)
        * 6.4. в "Request Payload" {"user_action":"X"} (где X выбранная оценка)
  * 7. проверить, что установилась "запрещающая" кука (TODO: как временное решение в dev tools->Application->Cookies):
        * 7.1. "Name" равен "NPS_sended"
        * 7.2. "Value" равен "1"
        * 7.3. "Path" равен "/" (уточнить по ТЗ, на всякий)
        * 7.4. "Expires / Max-Age" **не** равен "Session" (ожидаемое значение уточнить по ТЗ)
  * 8. закрыть активную вкладку (Ctrl+W для хрома)


3.1.4. Всплывающее окно / Дефолтное окно / Выбор отрицательной оценки [0, 3, 6]
  * 0. повторить пункты [1-6] для *оценок* [0, 3, 6] - выбирая соответственно нужную кнопку в пункте 3
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. открыть dev tools->Network
  * 3. нажать кнопку с цифрой выбранной оценки
  * 4. убедиться, что всплывашка изменилась:
        * 4.1. изменился текст
        * 4.2. исчезли кнопки с оценками (и надписи над ними)
        * 4.3. появилось поле ввода
  * 5. проверить, что в dev tools->Network **не** появился запрос "nps" с типом "xhr"
  * 6. закрыть активную вкладку (Ctrl+W для хрома)

  Сама всплывашка с отзывом проверяется в сьюте 3.2.


3.2.1. Всплывающее окно / Окно с отзывом / Внешний вид
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. на всплывашке нажать кнопку с цифрой 0
  * 3. проверить наличие крестика в правом верхнем углу всплывашки
  * 4. проверить текст всплывашки: "Would you like write a message about your opinion?"
  * 5. проверить наличие поля ввода
  * 6. проверить наличие кнопки "SEND" под полем ввода
  * 7. закрыть активную вкладку (Ctrl+W для хрома)


3.2.2. Всплывающее окно / Окно с отзывом / Закрытие по крестику
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. на всплывашке нажать кнопку с цифрой 0
  * 3. открыть dev tools
  * 4. нажать на крестик в правом верхнем углу всплывашки
  * 5. проверить, что всплывашка закрылась
  * 6. проверить, что установилась "запрещающая" кука (TODO: как временное решение в dev tools->Application->Cookies):
        * 6.1. "Name" равен "NPS_sended"
        * 6.2. "Value" равен "1"
        * 6.3. "Path" равен "/" (уточнить по ТЗ, на всякий)
        * 6.4. "Expires / Max-Age" **не** равен "Session" (ожидаемое значение уточнить по ТЗ)
  * 7. проверить, что в dev tools->Network **не** появился запрос "nps" с типом "xhr"
  * 8. закрыть активную вкладку (Ctrl+W для хрома)


3.2.3.1. Всплывающее окно / Окно с отзывом / Отправка отзыва / С пустым комментарием
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. открыть dev tools->Network
  * 3. нажать кнопку с цифрой 1
  * 4. нажать на кнопку "SEND"
  * 5. проверить, что в dev tools->Network появился запрос "nps" с типом "xhr"
  * 6. кликнуть по запросу в столбце "Name", выбрать "Headers", проверить:
        * 6.0. в "General" -> "Status Code" = "200 OK"
        * 6.1. в "General" -> "Request URL" заканчивается на "/nps"
        * 6.2. в "General" -> "Request Method" = "POST"
        * 6.3. в "Request Headers" -> "Content-Type:" = "application/json; charset=UTF-8" (TODO: возможно убрать, после уточнения ТЗ)
        * 6.4. в "Request Payload" {user_action: "1", feedback: ""}
  * 7. проверить, что установилась "запрещающая" кука (TODO: как временное решение в dev tools->Application->Cookies):
        * 7.1. "Name" равен "NPS_sended"
        * 7.2. "Value" равен "1"
        * 7.3. "Path" равен "/" (уточнить по ТЗ, на всякий)
        * 7.4. "Expires / Max-Age" **не** равен "Session" (ожидаемое значение уточнить по ТЗ)
  * 8. закрыть активную вкладку (Ctrl+W для хрома)


3.2.3.2. Всплывающее окно / Окно с отзывом / Отправка отзыва / С комментарием
  * 1. открыть "чистый" браузер, перейти по адресу сервиса, в dev tools консоли выполнить:

    ::

        document.cookie = "NPS_sended=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/;";
        win = open('/');
        win.Math.random = function() {return 0;};
        win.focus()

  * 2. открыть dev tools->Network
  * 3. нажать кнопку с цифрой 2
  * 4. в поле ввода ввести: "Привет Мир!11" (без кавычек соответственно)
  * 5. удалить два последних символа: "11"
  * 6. нажать на кнопку "SEND"
  * 7. проверить, что в dev tools->Network появился запрос "nps" с типом "xhr"
  * 8. кликнуть по запросу в столбце "Name", выбрать "Headers", проверить:
        * 8.0. в "General" -> "Status Code" = "200 OK"
        * 8.1. в "General" -> "Request URL" заканчивается на "/nps"
        * 8.2. в "General" -> "Request Method" = "POST"
        * 8.3. в "Request Headers" -> "Content-Type:" = "application/json; charset=UTF-8" (TODO: возможно убрать, после уточнения ТЗ)
        * 8.4. в "Request Payload" {user_action: "2", feedback: "Привет Мир!"}
  * 9. проверить, что установилась "запрещающая" кука (TODO: как временное решение в dev tools->Application->Cookies):
        * 9.1. "Name" равен "NPS_sended"
        * 9.2. "Value" равен "1"
        * 9.3. "Path" равен "/" (уточнить по ТЗ, на всякий)
        * 9.4. "Expires / Max-Age" **не** равен "Session" (ожидаемое значение уточнить по ТЗ)
  * 10. закрыть активную вкладку (Ctrl+W для хрома)
